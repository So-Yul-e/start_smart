# 백엔드 담당자 할일 체크리스트

## ✅ 완료된 작업

- [x] Express 서버 설정 (`backend/server.js`)
- [x] CORS 및 미들웨어 설정
- [x] REST API 라우트 구조 생성
- [x] `GET /api/brands` - 브랜드 목록 조회 (DB 연동 완료)
- [x] `POST /api/analyze` - 분석 실행 (DB 연동 완료)
- [x] `GET /api/result/:analysisId` - 결과 조회 (DB 연동 완료)
- [x] 상권 분석 모듈 (`backend/market/`) 구현
- [x] 지도 API 연동 (소상공인시장진흥공단, 카카오, 네이버, 구글)
- [x] PostgreSQL DB 설정 및 스키마 생성
- [x] 브랜드 데이터 DB화 (PDF에서 추출)
- [x] 매장 평균 데이터 DB화
- [x] 오케스트레이터 기본 구조 (`backend/services/orchestrator.js`)
- [x] 프론트엔드 연동 가이드 작성
- [x] 환경변수 설정 가이드 작성
- [x] 병합 순서 가이드 작성

## ⚠️ 아직 하지 않은 작업

### 1. 리포트 생성 API 완성 ✅
**파일**: `backend/routes/report.js`

**완료된 작업**: 
- ✅ DB에서 분석 결과 조회 (`analysisRepository.getAnalysis` 사용)
- ✅ `analysisStore` 제거 및 DB 연동 완료
- ✅ 기본 구조 완성 (프론트엔드에서 PDF 생성하도록 데이터 반환)

**추가 구현 가능 (선택사항)**:
- 서버 사이드 PDF 생성 로직 (jsPDF 또는 pdfkit 사용)
- PDF 파일 저장 및 다운로드 기능

### 2. orchestrator.js 수정 완료 ✅
**파일**: `backend/services/orchestrator.js`

**완료된 작업**:
- ✅ `getBrandById` 비동기 처리 (`await` 추가)

### 3. 다른 모듈 병합 대기 및 통합
**파일**: `backend/services/orchestrator.js`

**완료된 작업**:
- ✅ `engine/finance` 모듈 병합 완료
- ✅ `engine/decision` 모듈 병합 완료
- ✅ `calculateFinance`, `calculateDecision` 실제 함수 사용으로 변경
- ✅ Mock 데이터 제거

**완료된 작업**:
- ✅ `engine/finance` 모듈 병합 완료
- ✅ `engine/decision` 모듈 병합 완료
- ✅ `ai/consulting` 모듈 구현 및 통합 완료
- ✅ `calculateFinance`, `calculateDecision`, `generateConsulting` 실제 함수 사용으로 변경
- ✅ Mock 데이터 제거

**남은 작업**:
- [ ] `ai/roadview` 모듈 병합 후 `analyzeRoadview` import
- [ ] 각 모듈의 export 형식이 `shared/interfaces.js`와 일치하는지 확인
- [ ] 통합 테스트 (AI 컨설팅 포함)

### 3. 상권 분석 개선 ✅
**파일**: `backend/market/index.js`

**완료된 작업**:
- ✅ `analyzeMarket` 함수에 `brandId` 파라미터 추가
- ✅ 같은 브랜드 카페 필터링 로직 구현
- ✅ `orchestrator.js`에서 `brandId` 전달하도록 수정
- ✅ 상권 점수 계산에 같은 브랜드 수 반영

**추가 개선 가능한 부분 (선택사항)**:
- [ ] 유동인구 추정 로직 개선 (실제 API 연동)
- [ ] 경쟁 밀도 계산 로직 개선
- [ ] 상권 점수 계산 알고리즘 추가 개선

### 4. 에러 처리 및 로깅 개선 (선택사항)
- [ ] 더 상세한 에러 메시지
- [ ] 에러 로깅 시스템 (파일 저장 등)
- [ ] 재시도 로직 (API 호출 실패 시)

### 5. API 문서화 (선택사항)
- [ ] Swagger/OpenAPI 문서 생성
- [ ] Postman Collection 생성

## 🔄 다른 팀원 작업 대기 중

다음 모듈들이 병합되면 통합 작업 필요:

1. **engine/finance** - 손익 계산
2. **engine/decision** - 점수/신호등 판단
3. **ai/roadview** - 로드뷰 분석
4. **ai/consulting** - AI 컨설팅
5. **frontend** - UI 구현

## 📋 다음 단계 우선순위

### ✅ 완료된 작업
1. ~~**리포트 생성 API 완성**~~ ✅ 완료
   - DB에서 결과 조회 완료
   - 기본 구조 완성 (프론트엔드에서 PDF 생성)

2. ~~**상권 분석 개선**~~ ✅ 완료
   - 같은 브랜드 필터링 로직 구현 완료

### 다른 팀원 작업 대기 중
3. **다른 모듈 병합 및 통합**
   - 병합 순서 가이드 참고 (`backend/병합_순서_가이드.md`)
   - `orchestrator.js`의 TODO 주석 해제
   - 통합 테스트

### 선택사항 (시간 여유 있을 때)
4. 에러 처리 개선
5. API 문서화 (Swagger/OpenAPI)
6. 유동인구 API 연동 (상권 분석 고도화)

## ✅ 해결된 문제점

1. ~~**report.js가 analysisStore 사용**~~ ✅ 해결
   - `analysisRepository.getAnalysis` 사용하도록 수정 완료

2. ~~**orchestrator.js의 getBrandById 호출**~~ ✅ 해결
   - `await getBrandById(brandId)`로 비동기 처리 완료

3. ~~**상권 분석 sameBrand 계산**~~ ✅ 해결
   - `analyzeMarket` 함수에 `brandId` 파라미터 추가
   - 같은 브랜드 카페 필터링 로직 구현 완료
