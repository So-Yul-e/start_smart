# 서버 시작 체크리스트

## 올바른 서버 시작 방법

### 1. 프로젝트 루트에서 실행

```bash
# 프로젝트 루트 디렉토리에서 실행
cd /Users/so-yul/Documents/workspace/projects/StartSmart
npm start
```

또는:

```bash
node backend/server.js
```

### 2. 정상 실행 확인

서버가 정상적으로 시작되면 다음과 같은 메시지가 출력됩니다:

```
🚀 Server running on http://localhost:3000
📊 Health check: http://localhost:3000/health
🔒 로컬에서만 접근 가능 (다른 기기 접근 불가)
```

### 3. 헬스 체크 확인

다른 터미널에서:

```bash
curl http://localhost:3000/health
```

또는 브라우저에서:
```
http://localhost:3000/health
```

정상 응답:
```json
{"status":"ok","timestamp":"2025-01-27T..."}
```

---

## 자주 하는 실수

### ❌ 잘못된 방법들

1. **잘못된 디렉토리에서 실행**
   ```bash
   cd backend
   npm start  # ❌ package.json이 없어서 실패
   ```

2. **서버를 시작하지 않고 테스트 실행**
   ```bash
   npm run test:flow  # ❌ 서버가 실행 중이 아니면 실패
   ```

3. **포트가 이미 사용 중**
   ```bash
   # 다른 프로세스가 3000 포트를 사용 중
   # 해결: 포트를 사용하는 프로세스 종료
   lsof -ti:3000 | xargs kill -9
   ```

4. **환경변수 파일 누락**
   ```bash
   # .env 파일이 없으면 DB 연결 실패
   # 해결: .env 파일 확인
   ls -la .env
   ```

---

## 서버 시작 전 확인 사항

### ✅ 체크리스트

- [ ] 프로젝트 루트 디렉토리에 있는지 확인
- [ ] `.env` 파일이 존재하는지 확인
- [ ] PostgreSQL이 실행 중인지 확인
- [ ] 포트 3000이 사용 가능한지 확인
- [ ] `npm install`이 완료되었는지 확인

---

## 서버 시작 명령어 비교

| 명령어 | 설명 | 사용 시기 |
|--------|------|-----------|
| `npm start` | 프로덕션 모드 (변경사항 자동 반영 안 됨) | 일반 실행 |
| `npm run dev` | 개발 모드 (nodemon, 자동 재시작) | 개발 중 (변경사항 자동 반영) |
| `node backend/server.js` | 직접 실행 | 스크립트에서 사용 |

---

## 문제 해결

### 문제 1: "Cannot find module"

**원인**: `node_modules`가 없거나 의존성이 설치되지 않음

**해결**:
```bash
npm install
```

### 문제 2: "Port 3000 is already in use"

**원인**: 다른 프로세스가 포트 3000을 사용 중

**해결**:
```bash
# 포트 사용 중인 프로세스 확인
lsof -ti:3000

# 프로세스 종료
lsof -ti:3000 | xargs kill -9

# 또는 다른 포트 사용
PORT=3001 npm start
```

### 문제 3: "Database connection failed"

**원인**: PostgreSQL이 실행 중이 아니거나 `.env` 설정이 잘못됨

**해결**:
```bash
# PostgreSQL 실행 확인
pg_isready

# .env 파일 확인
cat .env | grep DB_
```

### 문제 4: 서버는 시작되지만 로그가 안 보임

**원인**: 서버가 다른 터미널에서 실행 중이거나, 로그가 다른 곳에 출력됨

**해결**:
- 서버를 실행한 터미널 확인
- 모든 터미널에서 `ps aux | grep node`로 실행 중인 프로세스 확인

---

## 권장 워크플로우

### 개발 중 (코드 변경이 자주 있을 때)

```bash
# 터미널 1: 개발 모드로 서버 실행 (자동 재시작)
npm run dev
```

### 테스트 실행 시

```bash
# 터미널 1: 서버 실행
npm start

# 터미널 2: 테스트 실행
npm run test:flow
```

---

## 현재 서버 상태 확인

서버가 실행 중인지 확인:

```bash
# 헬스 체크
curl http://localhost:3000/health

# 또는
curl http://localhost:3000/api/brands
```

응답이 오면 서버가 정상 실행 중입니다!
