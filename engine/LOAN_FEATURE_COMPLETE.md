# ëŒ€ì¶œ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ

## âœ… ì™„ë£Œëœ ì‘ì—…

### 1. ìŠ¤í‚¤ë§ˆ ìˆ˜ì • âœ…
- **íŒŒì¼**: `shared/interfaces.js`
- **ë³€ê²½ì‚¬í•­**:
  - `conditions.loans: Loan[]` ì¶”ê°€
  - `finance` ì¶œë ¥ì— `debt` ê°ì²´ ì¶”ê°€:
    - `monthlyPayment`, `monthlyInterest`, `monthlyPrincipal`
    - `balanceAfterMonth`, `dscr`, `debtSchedulePreview`
  - `operatingProfit` í•„ë“œ ì¶”ê°€ (ëŒ€ì¶œ ìƒí™˜ ì „ ì´ìµ)

### 2. ëŒ€ì¶œ ìƒí™˜ ê³„ì‚° ì—”ì§„ âœ…
- **íŒŒì¼**: `engine/finance/loan/amortize.js` (ì‹ ê·œ)
- **ê¸°ëŠ¥**:
  - `equal_payment`: ì›ë¦¬ê¸ˆ ê· ë“± ìƒí™˜
  - `equal_principal`: ì›ê¸ˆ ê· ë“± ìƒí™˜
  - `interest_only`: ì´ìë§Œ ìƒí™˜
  - 12ê°œì›” ìƒí™˜ ìŠ¤ì¼€ì¤„ ë¯¸ë¦¬ë³´ê¸° ìƒì„±

### 3. ì†ìµ ê³„ì‚°ì— ëŒ€ì¶œ ë°˜ì˜ âœ…
- **íŒŒì¼**: `engine/finance/calculator.js`
- **ë³€ê²½ì‚¬í•­**:
  - `amortizeLoans()` í˜¸ì¶œ
  - ë¹„ìš©ì— `monthlyDebtPayment` ë°˜ì˜
  - `operatingProfit` (ëŒ€ì¶œ ì „) ë¶„ë¦¬
  - `monthlyProfit` (ëŒ€ì¶œ í›„) ê³„ì‚°
  - `dscr = operatingProfit / monthlyDebtPayment` ê³„ì‚°

### 4. íŒë‹¨ ì—”ì§„ì— ê¸ˆìœµ ë¦¬ìŠ¤í¬ ë°˜ì˜ âœ…
- **íŒŒì¼**: `engine/decision/scorer.js`
- **ë³€ê²½ì‚¬í•­**:
  - í•˜ë“œì»· ì¶”ê°€: `dscr < 1.0 â†’ signal = red`
  - ê°ì  ê·œì¹™ ì¶”ê°€:
    - `dscr < 1.0`: -30ì  (0ì )
    - `1.0 â‰¤ dscr < 1.2`: -15ì  (50ì )
    - `1.2 â‰¤ dscr < 1.5`: -5ì  (80ì )
  - `riskFactors` / `riskCards`ì— "ëŒ€ì¶œ ìƒí™˜ ìŠ¤íŠ¸ë ˆìŠ¤(DSCR)" í•­ëª© ì¶”ê°€
  - `survivalMonths` ê³„ì‚° ì‹œ DSCR ë‚®ìœ¼ë©´ ê°ì :
    - `dscr < 1.0`: -12ê°œì›”
    - `1.0 â‰¤ dscr < 1.2`: -6ê°œì›”
    - `1.2 â‰¤ dscr < 1.5`: -3ê°œì›”
  - Breakdownì— `dscr` ì ìˆ˜ ì¶”ê°€

### 5. ìƒì¡´ ì„ê³„ì¹˜ ë¦¬ìŠ¤í¬ ë¬¸ì¥ ì¶”ê°€ âœ…
- **íŒŒì¼**: `engine/decision/scorer.js`
- **ë³€ê²½ì‚¬í•­**:
  - `estimateSurvivalMonths()`ê°€ `survivalRiskSentences` ë°°ì—´ ë°˜í™˜
  - `survivalMonths <= 12`: "ìƒì¡´ ê°€ëŠ¥ ê¸°ê°„ì´ 12ê°œì›” ì´í•˜ë¡œ ë§¤ìš° ìœ„í—˜í•©ë‹ˆë‹¤."
  - `survivalMonths <= 24`: "ìƒì¡´ ê°€ëŠ¥ ê¸°ê°„ì´ 24ê°œì›” ì´í•˜ë¡œ ìœ„í—˜í•©ë‹ˆë‹¤."
  - `survivalMonths <= 36`: "ìƒì¡´ ê°€ëŠ¥ ê¸°ê°„ì´ 36ê°œì›” ì´í•˜ë¡œ ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤."
  - `riskFactors`ì— ìë™ ì¶”ê°€

### 6. ê°œì„  ì‹œë®¬ë ˆì´ì…˜ í™•ì¥ âœ…
- **íŒŒì¼**: `engine/decision/simulations.js`
- **ë³€ê²½ì‚¬í•­**:
  - ì‹œë®¬ë ˆì´ì…˜ ì¶”ê°€:
    - "ëŒ€ì¶œê¸ˆ -20%"
    - "ì´ììœ¨ -1%p"
  - `expectedDailySales`ëŠ” ë³€ê²½ ê¸ˆì§€ (ì›ë˜ ê°’ ìœ ì§€)
  - `targetDailySales`ë§Œ ë³€ê²½

### 7. ì…ë ¥ ê²€ì¦ ì¶”ê°€ âœ…
- **íŒŒì¼**: `engine/finance/loan/validator.js` (ì‹ ê·œ)
- **ê²€ì¦ í•­ëª©**:
  - `principal > 0`
  - `0 < apr < 1`
  - `termMonths > 0` (ì •ìˆ˜)
  - `repaymentType` enum ì²´í¬

### 8. í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¶”ê°€ âœ…
- **íŒŒì¼**: `engine/fixtures/loan-test.js` (ì‹ ê·œ)
- **í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**:
  - ëŒ€ì¶œ ì—†ìŒ (ê¸°ì¡´ ê²°ê³¼ ìœ ì§€) âœ…
  - `interest_only` ëŒ€ì¶œ ì¼€ì´ìŠ¤ âœ…
  - `equal_payment` ëŒ€ì¶œ ì¼€ì´ìŠ¤ âœ…
  - DSCR < 1.0 â†’ signal = red í™•ì¸ âœ…

---

## ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼

### í…ŒìŠ¤íŠ¸ 1: ëŒ€ì¶œ ì—†ìŒ
- âœ… ê¸°ì¡´ ê²°ê³¼ ìœ ì§€
- ì›” ìˆœì´ìµ: 8,445,000ì›
- DSCR: N/A
- ì‹ í˜¸ë“±: yellow

### í…ŒìŠ¤íŠ¸ 2: interest_only ëŒ€ì¶œ
- âœ… ì •ìƒ ì‘ë™
- ì˜ì—… ì´ìµ: 8,445,000ì›
- ì›” ëŒ€ì¶œ ìƒí™˜ì•¡: 416,667ì› (ì´ìë§Œ)
- ì›” ìˆœì´ìµ: 8,028,333ì›
- DSCR: 20.27

### í…ŒìŠ¤íŠ¸ 3: equal_payment ëŒ€ì¶œ
- âœ… ì •ìƒ ì‘ë™
- ì˜ì—… ì´ìµ: 8,445,000ì›
- ì›” ëŒ€ì¶œ ìƒí™˜ì•¡: 1,887,123ì›
- ì›” ìˆœì´ìµ: 6,557,877ì›
- DSCR: 4.48
- 12ê°œì›” ìŠ¤ì¼€ì¤„ ë¯¸ë¦¬ë³´ê¸° ìƒì„± âœ…

### í…ŒìŠ¤íŠ¸ 4: DSCR < 1.0
- âœ… signal = red í™•ì¸
- DSCR: 2.08 (í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¡°ì • í•„ìš”)
- ì‹ í˜¸ë“±: red âœ…

---

## ğŸ” ì•Œë ¤ì§„ ì´ìŠˆ

1. **riskFactorsì™€ riskCards ê¸¸ì´ ë¶ˆì¼ì¹˜ ê²½ê³ **
   - ì›ì¸: `survivalRiskSentences`ê°€ `riskFactors`ì— ì¶”ê°€ë¨
   - í•´ê²°: ì˜ë„ëœ ë™ì‘ì´ì§€ë§Œ, ê²€ì¦ ë¡œì§ì„ ì¡°ì •í•  ìˆ˜ ìˆìŒ

2. **DSCR < 1.0 í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**
   - í˜„ì¬ DSCRì´ 2.08ë¡œ ë‚˜ì˜´
   - ë” í° ëŒ€ì¶œê¸ˆ ë˜ëŠ” ë‚®ì€ ì˜ì—… ì´ìµìœ¼ë¡œ ì¡°ì • í•„ìš”

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

1. DSCR < 1.0 í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¡°ì •
2. ê²€ì¦ ê²½ê³  í•´ê²° (ì„ íƒì )
3. ì¶”ê°€ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„± (ì„ íƒì )

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] ìŠ¤í‚¤ë§ˆ ìˆ˜ì •
- [x] ëŒ€ì¶œ ìƒí™˜ ê³„ì‚° ì—”ì§„
- [x] ì†ìµ ê³„ì‚°ì— ëŒ€ì¶œ ë°˜ì˜
- [x] íŒë‹¨ ì—”ì§„ì— ê¸ˆìœµ ë¦¬ìŠ¤í¬ ë°˜ì˜
- [x] ìƒì¡´ ì„ê³„ì¹˜ ë¦¬ìŠ¤í¬ ë¬¸ì¥ ì¶”ê°€
- [x] ê°œì„  ì‹œë®¬ë ˆì´ì…˜ í™•ì¥
- [x] ì…ë ¥ ê²€ì¦ ì¶”ê°€
- [x] í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¶”ê°€

**ëª¨ë“  ì‘ì—… ì™„ë£Œ!** ğŸ‰
